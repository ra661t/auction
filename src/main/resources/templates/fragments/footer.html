<!-- footer.html -->
<footer th:fragment="footer">
    <p>&copy; EasyBid</p>

    <!-- âœ… ë¡œê·¸ì¸ëœ ì‚¬ìš©ìžë§Œ WebSocket ì•Œë¦¼ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ -->
    <div sec:authorize="isAuthenticated()">
        <!-- SockJS & STOMP ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
        <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.5.1/dist/sockjs.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.4/lib/stomp.min.js"></script>

        <!-- ì‹¤ì‹œê°„ ì•Œë¦¼ WebSocket ìŠ¤í¬ë¦½íŠ¸ -->
        <script th:inline="javascript">
            const socket = new SockJS('/ws');
            const stompClient = Stomp.over(socket);

            stompClient.connect({}, function (frame) {
                console.log('âœ… WebSocket ì—°ê²° ì„±ê³µ:', frame);

                stompClient.subscribe('/user/queue/notifications', function (message) {
                    const msg = message.body;
                    alert('ðŸ”” ì•Œë¦¼: ' + msg);

                    const badge = document.getElementById("unread-badge");
                    if (badge) {
                        badge.textContent = '!';
                        badge.style.display = 'inline-block';
                    }
                });
            });
        </script>
    </div>
</footer>
